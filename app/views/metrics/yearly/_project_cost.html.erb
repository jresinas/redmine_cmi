<tr>
  <th rowspan=13><%= l('cmi.label_cost') %></th>
  <th rowspan="4"><%= l('cmi.label_done') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_spent_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.hhrr_cost_incurred_year(metric.year) %>
      <% else %>
        <%= currency metric.hhrr_cost_incurred %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_others') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_other_spent_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.material_cost_incurred_year(metric.year) %>
      <% else %>
        <%= currency metric.material_cost_incurred %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_bpo') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_bpo_spent_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.bpo_cost_incurred_year(metric.year) %>
      <% else %>
        <%= currency metric.bpo_cost_incurred %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l(:label_total) %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_total_spent_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.total_cost_incurred_year(metric.year) %>
      <% else %>
        <%= currency metric.total_cost_incurred %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th rowspan=4><%= l('cmi.label_remaining') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_remaining_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.hhrr_cost_remaining_year(metric.year) %>
      <% else %>
        <%= currency metric.hhrr_cost_remaining %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_others') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_other_remaining_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.material_cost_remaining_year(metric.year) %>
      <% else %>
        <%= currency metric.material_cost_remaining %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_bpo') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_bpo_remaining_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.bpo_cost_remaining_year(metric.year) %>
      <% else %>
        <%= currency metric.bpo_cost_remaining %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l(:label_total) %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_total_remaining_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.total_cost_remaining_year(metric.year) %>
      <% else %>
        <%= currency metric.total_cost_remaining %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>

<tr>
  <th rowspan=4><%= l('cmi.label_planned') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_planned_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.hhrr_cost_scheduled_year(metric.year) %>
      <% else %>
        <%= currency metric.hhrr_cost_scheduled %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_others') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_other_planned_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.material_cost_scheduled_year(metric.year) %>
      <% else %>
        <%= currency metric.material_cost_scheduled %>
      <% end %>       
    <% end -%>
   <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_bpo') %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_bpo_planned_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.bpo_cost_scheduled_year(metric.year) %>
      <% else %>
        <%= currency metric.bpo_cost_scheduled %>
      <% end %>  
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l(:label_total) %></td>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_total_planned_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.total_cost_scheduled_year(metric.year) %>
      <% else %>
        <%= currency metric.total_cost_scheduled %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th colspan="2"><%= l('cmi.label_graphs') %></th>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_chart_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <img src="http://chart.apis.google.com/chart?cht=bhs&chd=t:<%= metric.hhrr_cost_percent_incurred_year(metric.year).round(2) %>,<%= metric.material_cost_percent_incurred_year(metric.year).round(2) %>,<%= metric.bpo_cost_percent_incurred_year(metric.year).round(2) %>,<%= metric.total_cost_percent_incurred_year(metric.year).round(2) %>|100,100,100&chco=4D89F9,C6D9FD&  chbh=10,5,10&chs=250x90&chxt=x,y&chxl=0:|0|50|100|1:|<%=l :label_total %>: <%= percent metric.total_cost_percent_incurred_year(metric.year) %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent_incurred_year(metric.year) %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent_incurred_year(metric.year) %>|<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent_incurred_year(metric.year) %>|"/>
        <img src="http://chart.apis.google.com/chart?cht=p3&chd=t:<%= metric.hhrr_cost_percent_year(metric.year).round(2) %>,<%= metric.material_cost_percent.round(2) %>,<%= metric.bpo_cost_percent_year(metric.year).round(2) %>&chs=250x50&chl=<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent_year(metric.year) %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent_year(metric.year) %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent_year(metric.year) %>|"/>
      <% else %>
        <img src="http://chart.apis.google.com/chart?cht=bhs&chd=t:<%= metric.hhrr_cost_percent_incurred.round(2) %>,<%= metric.material_cost_percent_incurred.round(2) %>,<%= metric.bpo_cost_percent_incurred.round(2) %>,<%= metric.total_cost_percent_incurred.round(2) %>|100,100,100&chco=4D89F9,C6D9FD&  chbh=10,5,10&chs=250x90&chxt=x,y&chxl=0:|0|50|100|1:|<%=l :label_total %>: <%= percent metric.total_cost_percent_incurred %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent_incurred %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent_incurred %>|<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent_incurred %>|"/>
        <img src="http://chart.apis.google.com/chart?cht=p3&chd=t:<%= metric.hhrr_cost_percent.round(2) %>,<%= metric.material_cost_percent.round(2) %>,<%= metric.bpo_cost_percent.round(2) %>&chs=250x50&chl=<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent %>|"/>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
