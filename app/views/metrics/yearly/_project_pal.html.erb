<tr>
  <th rowspan=4><%= l('cmi.label_pal') %></th>
  <th rowspan="1" colspan="2"><%= l('cmi.label_profit') %></th>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "profit_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency @project.cmi_project_info.total_income_year(metric.year) %>
      <% else %>
        <%= currency @project.cmi_project_info.total_income %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th rowspan=1 colspan="2"><%= l('cmi.label_staff_cost') %></th>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "staff_cost_currently_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency (metric.hhrr_cost_scheduled_year(metric.year) + metric.bpo_cost_scheduled_year(metric.year)) %>
      <% else %>
        <%= currency (metric.hhrr_cost_scheduled + metric.bpo_cost_scheduled) %>
      <% end %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th rowspan=1 colspan="2"><%= l('cmi.label_providers_cost') %></th>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "providers_cost_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.material_cost_scheduled_year(metric.year) %>
      <% else %>
        <%= currency metric.material_cost_scheduled %>
      <% end %>      
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th rowspan=1 colspan="2"><%= l('cmi.label_cm') %></th>
  <% @metrics.each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cm_#{i}", :class => "issue" do -%>
      <% if metric.checkpoint.new_record? %>
        <%= currency metric.scheduled_margin_year(metric.year) %> (<%= percent metric.scheduled_margin_percent_year(metric.year) %>)
      <% else %>
        <%= currency metric.scheduled_margin %> (<%= percent metric.scheduled_margin_percent %>)
      <% end %>      
    <% end -%>
  <% end -%>
</tr>